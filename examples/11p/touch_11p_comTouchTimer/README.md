# 通过电脑控制点击

## 代码功能说明

先在timer.json文件中配置好以电脑时间为参考的定时点击程序，当时间达到时，程序会通过电脑上的串口(COM口)给arduino发送数据控制点击,当通过串口给板子发送字符'1'或者'2'时，会触发点击器点击动作一次。点击时间为30ms.
```
'1' —-> J1
'2' --> J2
'3' --> J3
'4' --> J4
'5' --> J5
'6' --> J6
'7' --> J7
'8' --> J8
'9' --> J9
'a' --> J10
'b' --> Jok
```

注意，发送的是asiic中的字符，并不是十进制或者十六进制的数字1~9

##### 电脑上位机说明

在python_code目录下为电脑端有界面的上位机程序源码。串口部分使用python的pyserial串口模块。

##### 上位机时间配置文件timer.json说明

``` json
[
    {"time": "2020-01-13|12:03:25!000", "number": {"key":"1","times":0,"delay":10}},
    {"time": "2020-01-13|12:03:30!000", "number": {"key":"1","times":0,"delay":10}}
]
```
每行中的参数由时间time，number两项组成

time的格式为"年-月-日|时:分:秒!毫秒"组成,当定时为每天的固定时间触发时，可以设置为"时:分:秒!毫秒"这种去掉日期的格式。

number项中的内容为时间达到时那一个点击头被点击，对应串口要发送的点击对像
```
"1" --> J1
"2" --> J2
"3" --> J3
"4" --> J4
"5" --> J5
"6" --> J6
"7" --> J7
"8" --> J8
"9" --> J9
"a" --> J10
"b" --> Jok
```
times参数内容为时到到了之间这个按键要连按多少次，这个数值为大于等于0的整数，当值为0时表示不点击

delay，这个参数表示如果times的值大于1时是多次点击时，多次点击之间的时间间隔是多久，delay的时间单位是毫秒


##### Arduino程序说明
comTouchTimer目录为arduino上开发板程序源码，这里使用到了SCoop的Arduino的多线程库。这个库在项目上层的lib目录下

## USB转串口芯片驱动程序下载

这是ch340芯片的官方驱动，有linux，mac，windows等等驱动,选择自已适合自已电脑系统的驱动
http://www.wch.cn/products/CH340.html


## 串口工具使用说明

串口控制上位机程序界面在设置好串口号后，点打开串口按钮等待串口连接成功，一般会在5秒内连接成功。

串连接成功后，把点击头放到手机上，然后在电脑的程序上点击相应的数字编号即可触发相头插孔的点击头发生点击动作。



点击头购买地址:

https://fengmm521.taobao.com
